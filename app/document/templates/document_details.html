<!-- app/document/templates/document_preview.html -->
{% extends "base.html" %}
{% block title %}Preview: {{ document.title }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{{ url_for('document_bp.list_documents') }}">Documents</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{ document.title }}</li>
        </ol>
    </nav>

    <div class="card shadow-sm">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h1 class="h4 mb-0">Document Preview: {{ document.title }}</h1>
            <div>
                <!-- Add Edit/Download buttons here if needed -->
                <!-- Example: <a href="#" class="btn btn-sm btn-secondary me-1">Edit</a> -->
                <!-- Example: <a href="{{ url_for('document_bp.preview_document', document_id=document.id) }}" class="btn btn-sm btn-primary">Preview</a> -->
                 <form action="{{ url_for('document_bp.delete_document', document_id=document.id) }}" method="post" style="display: inline;">
                    <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this document?');">
                        <i class="bi bi-trash"></i> Delete
                    </button>
                </form>
            </div>
        </div>
        <div class="card-body">
            <dl class="row">
                <dt class="col-sm-3">Original Filename</dt>
                <dd class="col-sm-9">{{ document.file_name }}</dd>

                <dt class="col-sm-3">Workspace</dt>
                <dd class="col-sm-9">{{ document.workspace.name }}</dd>

                <dt class="col-sm-3">Uploaded By</dt>
                <dd class="col-sm-9">{{ document.uploader.first_name or 'N/A' }} {{ document.uploader.last_name or '' }} ({{ document.uploader.email }})</dd>

                <dt class="col-sm-3">Uploaded At</dt>
                <dd class="col-sm-9">{{ document.uploaded_at.strftime('%Y-%m-%d %H:%M:%S') }} UTC</dd>

                <dt class="col-sm-3">File Size</dt>
                <dd class="col-sm-9">{{ document.file_size | filesizeformat }}</dd> <!-- Requires humanize filter or similar -->
                <!-- Simple fallback if filesizeformat filter isn't available -->
                <!-- <dd class="col-sm-9">{{ document.file_size }} bytes</dd> -->

                <dt class="col-sm-3">Stored Path</dt>
                <dd class="col-sm-9"><code>{{ document.file_path }}</code> (Relative to instance folder)</dd>

                {% if not file_exists %}
                <dt class="col-sm-3 text-danger">File Status</dt>
                <dd class="col-sm-9 text-danger">
                    <i class="bi bi-exclamation-triangle-fill"></i> Physical file not found at the stored path.
                </dd>
                {% endif %}

                {% if document.description %}
                <dt class="col-sm-12 mt-3">Description</dt>
                <dd class="col-sm-12 border rounded p-3 bg-light">
                    {{ document.description | safe }} {# Use safe filter to render HTML from TinyMCE #}
                </dd>
                {% endif %}
            </dl>
        </div>
    </div>
</div>
{% endblock %}

